<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ç¦å²¡ 2026 - åšå¤šç¾é£Ÿèˆ‡é…’æ—… (è©³ç´°å°èˆªç‰ˆ)</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@300;400;500;700&family=Shippori+Mincho:wght@500;700&display=swap" rel="stylesheet">
    
    <style>
        :root {
            /* --- æ–¹æ¡ˆ Bï¼šåšå¤šç¹”è— (Hakata Blue) --- */
            --bg-color: #1D2536;       /* å‹è‰² */
            --card-color: #F0F4F8;     /* ç°ç™½ */
            --accent-color: #EAA800;   /* å±±å¹è‰² */
            --text-on-dark: #FFFFFF;   
            --text-on-light: #0F172A;  
            --menu-bg: #141B2D;
            --weather-gradient: linear-gradient(135deg, #2b5876 0%, #4e4376 100%);
        }

        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }

        body {
            font-family: "Noto Sans TC", sans-serif;
            background-color: var(--bg-color);
            color: var(--text-on-dark);
            margin: 0; padding: 0;
            height: 100vh;
            display: flex; flex-direction: column; overflow: hidden;
        }

        /* --- Header --- */
        header {
            padding: 15px 20px;
            background-color: rgba(29, 37, 54, 0.98);
            border-bottom: 1px solid rgba(255,255,255,0.1);
            position: sticky; top: 0; z-index: 100;
            display: flex; justify-content: space-between; align-items: center;
            height: 60px;
        }
        header h1 { margin: 0; font-size: 1.2rem; font-weight: 700; letter-spacing: 1px; }
        
        .header-icons { display: flex; gap: 20px; align-items: center; }
        .header-btn { color: var(--text-on-dark); font-size: 1.2rem; cursor: pointer; text-decoration: none; position: relative;}

        /* --- Global Date Selector --- */
        .date-selector-container {
            background: var(--bg-color); z-index: 90;
            padding: 10px 20px 10px 20px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.3);
        }
        .date-selector { 
            display: flex; overflow-x: auto; gap: 10px; padding-bottom: 5px; scrollbar-width: none; 
            -webkit-overflow-scrolling: touch; 
        }
        .date-selector::-webkit-scrollbar { display: none; }
        
        .date-chip {
            background: rgba(255,255,255,0.1); padding: 8px 12px; border-radius: 16px;
            white-space: nowrap; font-size: 0.85rem; cursor: pointer; color: #aaa;
            display: flex; flex-direction: column; align-items: center; min-width: 55px;
            transition: all 0.2s; border: 1px solid transparent;
        }
        .date-chip.active {
            background: var(--accent-color); color: #0F172A;
            box-shadow: 0 0 10px rgba(234, 168, 0, 0.4); transform: scale(1.05); font-weight: bold;
        }

        /* --- Main Content --- */
        main { flex: 1; overflow-y: hidden; position: relative; }

        .page {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            overflow-y: auto; padding: 10px 0 90px 0;
            display: none; opacity: 0; transition: opacity 0.3s ease;
            background-color: var(--bg-color);
            -webkit-overflow-scrolling: touch;
        }
        .page.active { display: block; opacity: 1; z-index: 10; }
        
        /* Map Page Specific */
        #page-map { padding: 0 0 80px 0; } 
        #map-container { width: 100%; height: 100%; }

        /* å­é é¢ */
        .sub-page {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            background-color: var(--bg-color); z-index: 2000;
            display: flex; flex-direction: column;
            transform: translateX(100%); transition: transform 0.3s cubic-bezier(0.4, 0.0, 0.2, 1);
        }
        .sub-page.open { transform: translateX(0); }
        .sub-header {
            padding: 15px 20px; background: var(--menu-bg);
            border-bottom: 1px solid rgba(255,255,255,0.1);
            display: flex; align-items: center; gap: 15px;
        }
        .back-btn { font-size: 1.2rem; color: var(--accent-color); background: none; border: none; padding: 5px; cursor: pointer;}
        .sub-header h2 { margin: 0; font-size: 1.1rem; font-weight: 700; }
        .sub-content { 
            flex: 1; overflow-y: auto; padding: 20px; 
            -webkit-overflow-scrolling: touch;
        }

        /* --- Timeline & Cards --- */
        .timeline-container { padding: 0 20px; }
        .timeline-item {
            position: relative; padding-left: 25px; padding-bottom: 30px;
            border-left: 2px solid rgba(234, 168, 0, 0.3);
        }
        .timeline-item:last-child { border-left: 2px solid transparent; padding-bottom: 0; }
        .timeline-item::before {
            content: ''; position: absolute; left: -6px; top: 18px;
            width: 10px; height: 10px; background: var(--accent-color);
            border-radius: 50%; box-shadow: 0 0 0 4px var(--bg-color);
        }

        .card {
            background-color: var(--card-color); color: var(--text-on-light);
            border-radius: 12px; padding: 16px; margin-bottom: 5px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.2); cursor: pointer;
            position: relative;
        }
        .card:active { transform: scale(0.98); }
        .card-time { font-size: 0.85rem; color: #B45309; font-weight: 700; display: block; margin-bottom: 6px; }
        .card-title { font-size: 1.1rem; font-weight: 700; margin: 0 0 8px 0; line-height: 1.4; padding-right: 10px;}
        .card-price {
            position: absolute; bottom: 12px; right: 15px;
            font-weight: bold; color: #0369a1; font-size: 0.9rem;
            background: rgba(255,255,255,0.6); padding: 2px 6px; border-radius: 4px;
        }

        .tags { display: flex; gap: 6px; flex-wrap: wrap; margin-top: 5px; max-width: 70%; }
        .card-tag { font-size: 0.7rem; background: #CBD5E1; padding: 3px 8px; border-radius: 4px; color: #334155; }
        .card-tag.highlight { background: #FEF3C7; color: #B45309; border: 1px solid #FCD34D; }
        .card-tag.tips { background: #e0f2fe; color: #0369a1; }
        .card-tag.alert { background: #fee2e2; color: #b91c1c; border: 1px solid #f87171; font-weight: bold;}

        /* --- Weather Styles --- */
        .weather-card {
            background: var(--weather-gradient);
            border-radius: 16px; padding: 25px; margin: 20px;
            text-align: center; color: white;
            box-shadow: 0 10px 20px rgba(0,0,0,0.3);
        }
        .weather-main { display: flex; justify-content: space-around; align-items: center; margin: 20px 0; }
        .weather-icon { font-size: 3.5rem; }
        .weather-temp { font-size: 3rem; font-weight: 300; }
        .weather-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-top: 20px; background: rgba(255,255,255,0.1); padding: 15px; border-radius: 12px; }
        .w-item { font-size: 0.9rem; display: flex; align-items: center; gap: 8px; }

        /* --- Shopping Styles --- */
        .shopping-section-title { font-weight: 700; margin: 0 0 10px 0; color: var(--accent-color); border-bottom: 1px solid #555; padding-bottom: 5px;}
        .shopping-group { margin-bottom: 25px; background: rgba(255,255,255,0.05); padding: 15px; border-radius: 12px; }

        /* --- Tools Grid --- */
        .tools-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; padding: 10px; }
        .tool-btn {
            background: rgba(255,255,255,0.08); padding: 25px 15px;
            border-radius: 16px; text-align: center;
            border: 1px solid rgba(255,255,255,0.05); cursor: pointer;
        }
        .tool-btn i { font-size: 2.2rem; color: var(--accent-color); margin-bottom: 12px; display: block; }

        /* --- Lists --- */
        .checklist-item {
            background: rgba(255,255,255,0.08); padding: 15px; margin-bottom: 12px;
            border-radius: 8px; display: flex; align-items: center; gap: 15px;
        }
        .checklist-item.checked { opacity: 0.5; }
        .checklist-item.checked span { text-decoration: line-through; }
        .checklist-item input { width: 22px; height: 22px; accent-color: var(--accent-color); }
        
        /* --- Footer --- */
        nav.bottom-nav {
            position: fixed; bottom: 0; width: 100%;
            background-color: var(--menu-bg);
            display: flex; justify-content: space-around;
            padding: 10px 0 25px 0; border-top: 1px solid rgba(255,255,255,0.1); z-index: 100;
        }
        .nav-item { color: #64748B; text-align: center; font-size: 0.75rem; cursor: pointer; width: 25%; }
        .nav-item i { display: block; font-size: 1.4rem; margin-bottom: 4px; }
        .nav-item.active { color: var(--accent-color); }

        /* --- Modal --- */
        .modal {
            display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.85); z-index: 3000;
            justify-content: center; align-items: end; backdrop-filter: blur(3px);
        }
        .modal.open { display: flex; }
        .modal-content {
            background: var(--card-color); color: var(--text-on-light);
            width: 100%; max-width: 600px; max-height: 85vh;
            border-radius: 20px 20px 0 0; padding: 25px;
            overflow-y: auto; animation: slideUp 0.3s ease;
            -webkit-overflow-scrolling: touch;
        }
        @keyframes slideUp { from { transform: translateY(100%); } to { transform: translateY(0); } }
        .close-modal { position: absolute; top: 15px; right: 20px; font-size: 1.8rem; color: #888; cursor: pointer; }
        
        .info-row { margin: 12px 0; display: flex; align-items: flex-start; gap: 12px; font-size: 0.95rem; line-height: 1.6; }
        .info-row i { color: #B45309; margin-top: 4px; width: 20px; text-align: center; } 
        .note-box {
            background: #f8f8f8; border-left: 4px solid var(--accent-color);
            padding: 15px; margin: 20px 0; border-radius: 0 8px 8px 0;
            font-size: 0.95rem; color: #333; line-height: 1.7;
        }
        .link-btn {
            display: inline-block; background: #eee; color: #333; 
            padding: 6px 12px; border-radius: 4px; text-decoration: none; 
            font-size: 0.85rem; margin-top: 5px; border: 1px solid #ccc;
        }
        .action-btn {
            display: flex; justify-content: center; align-items: center; gap: 8px;
            width: 100%; padding: 14px; margin-top: 20px;
            background: var(--accent-color); color: #0F172A; 
            text-decoration: none; border-radius: 10px;
            font-weight: bold; font-size: 1rem; border: none; cursor: pointer;
        }
        
        /* Taxi Card */
        .taxi-card {
            background: #fff; color: #000; padding: 20px; 
            border: 4px solid #000; margin: 15px 0; 
            text-align: center; border-radius: 8px;
        }

        /* Hotel Info Card */
        .hotel-info-card {
            background: #fff; color: #333;
            border-radius: 12px; overflow: hidden;
            margin-bottom: 20px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        .hotel-info-header {
            background: var(--accent-color); color: #0F172A;
            padding: 15px 20px; font-weight: bold; font-size: 1.1rem;
        }
        .hotel-info-body { padding: 20px; }
        .hotel-detail-row {
            display: flex; margin-bottom: 12px; border-bottom: 1px solid #eee; padding-bottom: 12px;
        }
        .hotel-detail-row:last-child { border-bottom: none; margin-bottom: 0; padding-bottom: 0; }
        .hotel-label { font-weight: bold; width: 80px; flex-shrink: 0; color: #666; font-size: 0.9rem; }
        .hotel-val { flex: 1; font-size: 0.95rem; line-height: 1.5; }

    </style>
</head>
<body>

    <header>
        <h1>FUKUOKA 2026</h1>
        <div class="header-icons">
            <a href="googletranslate://" class="header-btn" title="Google Translate">
                <i class="fa-solid fa-language"></i>
            </a>
            <a href="#" class="header-btn fan-btn" onclick="openToolsPage(); return false;">
                <i class="fa-solid fa-martini-glass-citrus"></i>
            </a>
        </div>
    </header>

    <div class="date-selector-container">
        <div class="date-selector" id="date-selector"></div>
    </div>

    <main>
        <div id="page-itinerary" class="page active">
            <div class="timeline-container" id="timeline-container" style="padding-top: 20px;"></div>
            <div style="text-align:center; color:#666; font-size:0.8rem; margin:30px 0;">åšå¤šç¾é£Ÿ â€¢ ä¸€æœŸä¸€æœƒ</div>
        </div>

        <div id="page-map" class="page">
            <div id="map-container"></div>
            <div style="position:absolute; bottom:90px; left:10px; background:rgba(255,255,255,0.9); padding:8px 12px; border-radius:8px; color:#333; font-size:0.8rem; box-shadow:0 2px 5px rgba(0,0,0,0.3); pointer-events:none; z-index:999;">
                <i class="fa-solid fa-location-dot" style="color:var(--accent-color)"></i> é¡¯ç¤ºç•¶æ—¥è¡Œç¨‹åœ°é»
            </div>
        </div>

        <div id="page-weather" class="page">
            <div style="padding: 20px;">
                <h2 style="font-weight:700; text-align:center; margin-bottom:10px;">ç•¶æ—¥å¤©æ°£é å ±</h2>
                <div id="weather-content"></div>
                
                <div style="background:rgba(255,255,255,0.1); padding:15px; border-radius:12px; margin:20px 0; display:flex; align-items:center; justify-content:space-between; border:1px solid rgba(255,255,255,0.1);">
                    <div>
                        <div style="font-weight:bold; color:var(--accent-color);"><i class="fa-solid fa-glass-water"></i> æ°´åˆ†è£œçµ¦ Check</div>
                        <div style="font-size:0.8rem; opacity:0.7; margin-top:4px;">å–é…’å‰è«‹å…ˆå–æ°´</div>
                    </div>
                    <div style="display:flex; gap:15px; align-items:center;">
                        <button onclick="addWater()" style="background:var(--accent-color); border:none; color:#0F172A; width:45px; height:45px; border-radius:50%; font-size:1.2rem; cursor:pointer;"><i class="fa-solid fa-plus"></i></button>
                        <span id="water-count" style="font-size:2rem; font-weight:700; min-width:30px; text-align:center;">0</span>
                    </div>
                </div>

                <div class="note-box">
                    <div style="font-weight:bold; margin-bottom:5px; color:var(--accent-color);">2æœˆç¦å²¡æ°£å€™ TIPSï¼š</div>
                    å¹³å‡æ°£æº« 5Â°C - 12Â°Cï¼Œä»å±¬å¯’å†·å†¬å­£ã€‚<br>
                    æµ·é¢¨å¼·å‹ï¼ˆå°¤å…¶æ˜¯åˆ¥åºœèˆ‡æ¸¯å£é™„è¿‘ï¼‰ï¼Œé«”æ„Ÿæº«åº¦æ›´ä½ã€‚<br>
                    å®¤å…§/é›»è»Šæš–æ°£å¼·ï¼Œå»ºè­°æ´‹è”¥å¼ç©¿æ­ã€‚å¿…å‚™ä¿æº«ç“¶è£ç†±æ°´ã€‚
                </div>
            </div>
        </div>

        <div id="page-shopping" class="page">
            <div style="padding: 20px;">
                <h2 style="font-weight:700; text-align:center;">ä»Šæ—¥è³¼ç‰©å»ºè­°</h2>
                <p style="text-align:center; opacity:0.7; font-size:0.85rem; margin-bottom:20px;">æ ¹æ“šç•¶æ—¥è¡Œç¨‹åœ°é»æ¨è–¦</p>
                
                <div id="daily-shopping-list"></div>

                <div style="margin-top:40px; border-top:1px solid rgba(255,255,255,0.1); padding-top:20px;">
                    <h3 style="color:#aaa; font-size:1rem;">å…¨è¡Œç¨‹è³¼ç‰©æ¸…å–® (General)</h3>
                    <div id="general-shopping-container"></div>
                </div>
            </div>
        </div>

        <div id="page-tools" class="page">
            <h2 style="text-align:center; margin: 30px 0 20px 0; font-weight:700;">æ—…äººç™¾å¯¶ç®±</h2>
            <div class="tools-grid">
                <div class="tool-btn" onclick="openSubPage('info')">
                    <i class="fa-solid fa-hotel"></i><span>å¯¦ç”¨è³‡è¨Š</span>
                </div>
                <div class="tool-btn" onclick="openSubPage('packing')">
                    <i class="fa-solid fa-suitcase"></i><span>è¡Œææ¸…å–®</span>
                </div>
                <div class="tool-btn" onclick="switchMainPage('shopping')">
                    <i class="fa-solid fa-basket-shopping"></i><span>æŸ¥çœ‹è³¼ç‰©</span>
                </div>
                <div class="tool-btn" onclick="openSubPage('rate')">
                    <i class="fa-solid fa-yen-sign"></i><span>åŒ¯ç‡æ›ç®—</span>
                </div>
                <div class="tool-btn" onclick="openSubPage('safety')">
                    <i class="fa-solid fa-user-shield"></i><span>å®‰å…¨å ±å¹³å®‰</span>
                </div>
                <div class="tool-btn" onclick="openTipsModal()">
                    <i class="fa-regular fa-compass"></i><span>è·¯ç—´æ•‘æ˜Ÿ</span>
                </div>
                <div class="tool-btn" onclick="alert('è­¦å¯Ÿ: 110\næ¶ˆé˜²: 119\nå¤–äº¤éƒ¨: 800-0885-0885')">
                    <i class="fa-solid fa-phone-medical"></i><span>ç·Šæ€¥è¯çµ¡</span>
                </div>
            </div>
            <div style="text-align:center; margin-top:30px;">
                <button onclick="history.back()" style="background:none; border:1px solid #777; color:#fff; padding:10px 20px; border-radius:20px;">é—œé–‰ç™¾å¯¶ç®±</button>
            </div>
        </div>

        <div id="subpage-info" class="sub-page">
            <div class="sub-header"><button class="back-btn" onclick="closeSubPage('info')"><i class="fa-solid fa-arrow-left"></i></button><h2>ä½å®¿èˆ‡å¯¦ç”¨è³‡è¨Š</h2></div>
            <div class="sub-content">
                <div class="hotel-info-card">
                    <div class="hotel-info-header"><i class="fa-solid fa-bed"></i> ä½å®¿è³‡æ–™</div>
                    <div class="hotel-info-body">
                        <h3 style="margin:0 0 15px 0; line-height:1.4;">Hotel Wing International<br>åšå¤šæ–°å¹¹ç·šå£</h3>
                        
                        <div class="hotel-detail-row">
                            <div class="hotel-label">åœ°å€</div>
                            <div class="hotel-val">ã€’812-0013<br>ç¦å²¡çœŒç¦å²¡å¸‚åšå¤šåŒºåšå¤šé§…æ±1-17-17</div>
                        </div>
                        <div class="hotel-detail-row">
                            <div class="hotel-label">äº¤é€š</div>
                            <div class="hotel-val">JRåšå¤šç«™ç­‘ç´«å£æ­¥è¡Œ4åˆ†é˜ã€‚<br><span style="font-size:0.85rem; color:#666;">(å‡ºç­‘ç´«å£è½‰å³æ²¿åšå¤šé§…æ±è¡—ç›´èµ°ï¼Œéç¬¬ä¸€å€‹å°è·¯å£å³æ‰‹é‚Š)</span></div>
                        </div>
                        <div class="hotel-detail-row">
                            <div class="hotel-label">æ™‚é–“</div>
                            <div class="hotel-val">Check-in: 15:00<br>Check-out: 11:00</div>
                        </div>
                        
                        <a href="https://maps.google.com/?q=Hotel+Wing+International+Hakata+Shinkansen-guchi" target="_blank" class="action-btn" style="margin-top:15px; font-size:0.9rem; padding:10px;">
                            <i class="fa-solid fa-map-location-dot"></i> Google Map å°èˆª
                        </a>
                    </div>
                </div>

                <div class="hotel-info-card">
                    <div class="hotel-info-header" style="background:#555; color:#fff;"><i class="fa-solid fa-star"></i> è¨­æ–½äº®é»</div>
                    <div class="hotel-info-body">
                        <div class="hotel-detail-row">
                            <div class="hotel-label"><i class="fa-solid fa-mug-hot"></i> æ—©é¤</div>
                            <div class="hotel-val">06:00 - 09:30<br>å…è²»è¼•æ—©é¤ï¼ˆéºµåŒ…+é£²æ–™ï¼‰</div>
                        </div>
                        <div class="hotel-detail-row">
                            <div class="hotel-label"><i class="fa-solid fa-hot-tub-person"></i> å¤§æµ´å ´</div>
                            <div class="hotel-val">15:00 - 25:00 / 05:00 - 10:00<br>é…å‚™ ReFa ç´°æ³¡å™´é ­</div>
                        </div>
                        <div class="hotel-detail-row">
                            <div class="hotel-label"><i class="fa-solid fa-couch"></i> Lounge</div>
                            <div class="hotel-val">24å°æ™‚å…è²»å’–å•¡<br>18:00 - 23:00 æä¾›ä»˜è²»é…’æ°´</div>
                        </div>
                         <div class="hotel-detail-row">
                            <div class="hotel-label"><i class="fa-solid fa-wifi"></i> ç¶²è·¯</div>
                            <div class="hotel-val">å…¨å®¤å…è²» Wi-Fi</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div id="subpage-packing" class="sub-page">
            <div class="sub-header"><button class="back-btn" onclick="closeSubPage('packing')"><i class="fa-solid fa-arrow-left"></i></button><h2>è¡Œææ¸…å–®</h2></div>
            <div class="sub-content" id="packing-list-container"></div>
        </div>
        
        <div id="subpage-rate" class="sub-page">
            <div class="sub-header"><button class="back-btn" onclick="closeSubPage('rate')"><i class="fa-solid fa-arrow-left"></i></button><h2>åŒ¯ç‡æ›ç®—</h2></div>
            <div class="sub-content" style="display:flex; flex-direction:column; align-items:center; justify-content:center; height:80%;">
                <div style="background: rgba(255,255,255,0.05); padding: 20px; border-radius: 12px; width:100%;">
                    <div style="display:flex; justify-content:flex-end; margin-bottom:10px;">
                         <label style="font-size:0.8rem; color:#aaa;">åŒ¯ç‡: <input type="number" id="rate-setting" value="0.052" step="0.001" style="width:60px; background:transparent; color:#fff; border:1px solid #555; text-align:center; border-radius:4px;"></label>
                    </div>
                    <label>æ—¥å¹£ (JPY)</label><input type="number" id="jpy-input" placeholder="Â¥" oninput="calcRate('jpy')" style="width: 100%; padding: 15px; margin: 10px 0; font-size: 1.2rem; background: rgba(0,0,0,0.3); border: 1px solid #555; color: white; border-radius: 8px; text-align: center;">
                    <div style="text-align:center; font-size:1.5rem; margin:10px 0; color:var(--accent-color);">â‡…</div>
                    <label>æ¸¯å¹£ (HKD)</label><input type="number" id="hkd-input" placeholder="$" oninput="calcRate('hkd')" style="width: 100%; padding: 15px; margin: 10px 0; font-size: 1.2rem; background: rgba(0,0,0,0.3); border: 1px solid #555; color: white; border-radius: 8px; text-align: center;">
                </div>
            </div>
        </div>
        
        <div id="subpage-safety" class="sub-page">
            <div class="sub-header"><button class="back-btn" onclick="closeSubPage('safety')"><i class="fa-solid fa-arrow-left"></i></button><h2>å®‰å…¨åŠŸèƒ½</h2></div>
            <div class="sub-content">
                <div style="text-align: center; padding: 30px 20px; background: linear-gradient(135deg, #2E4B71, #1a2e47); border-radius: 16px; margin-bottom: 20px;" onclick="sendSafetyMessage()">
                    <i class="fa-brands fa-whatsapp" style="font-size:3rem; color:white; margin-bottom:15px;"></i>
                    <h3 style="margin:0 0 10px 0;">ä¸€éµå ±å¹³å®‰ (WhatsApp)</h3>
                    <p style="opacity:0.8; margin:0;">æŒ‰æ­¤ç™¼é€ä½ç½®çµ¦å®¶äºº</p>
                </div>
                <h3 style="border-bottom:1px solid #555; padding-bottom:10px; margin-top:30px;">ç·Šæ€¥è³‡è¨Š</h3>
                <div class="checklist-item" onclick="alert('110')"><i class="fa-solid fa-shield-halved" style="color:var(--accent-color);"></i><span>è­¦å¯Ÿå±€: 110</span></div>
                <div class="checklist-item" onclick="alert('119')"><i class="fa-solid fa-truck-medical" style="color:var(--accent-color);"></i><span>æ•‘è­·/æ¶ˆé˜²: 119</span></div>
            </div>
        </div>

    </main>

    <nav class="bottom-nav">
        <div class="nav-item active" onclick="switchMainPage('itinerary', this)"><i class="fa-solid fa-calendar-days"></i> è¡Œç¨‹</div>
        <div class="nav-item" onclick="switchMainPage('map', this)"><i class="fa-solid fa-map-location-dot"></i> åœ°åœ–</div>
        <div class="nav-item" onclick="switchMainPage('weather', this)"><i class="fa-solid fa-cloud-sun-rain"></i> å¤©æ°£</div>
        <div class="nav-item" onclick="switchMainPage('shopping', this)"><i class="fa-solid fa-basket-shopping"></i> è³¼ç‰©</div>
    </nav>

    <div id="detail-modal" class="modal">
        <div class="modal-content">
            <span class="close-modal" onclick="closeModal()">Ã—</span>
            <div class="modal-header"><h2 id="modal-title">æ¨™é¡Œ</h2><span id="modal-type" class="sub">é¡å‹</span></div>
            <div class="modal-body">
                
                <div id="taxi-card" class="taxi-card" style="display:none;">
                    <p style="font-size:0.8rem; color:#666; margin:0 0 5px 0;">é‹è»¢æ‰‹ã•ã‚“ã€ã“ã“ã¸ãŠé¡˜ã„ã—ã¾ã™ï¼ˆåšå¤šå¼ï¼šã“ã“ã«è¡Œãã‚“ã—ã‚ƒã„ï¼‰</p>
                    <h2 id="taxi-address" style="font-size:1.5rem; margin:5px 0; font-weight:bold; line-height:1.2;"></h2>
                    <p id="taxi-name" style="font-size:1rem; margin-top:5px; color:#444;"></p>
                </div>

                <div class="info-row"><i class="fa-regular fa-clock"></i><span id="modal-time">æ™‚é–“</span></div>
                <div class="info-row"><i class="fa-solid fa-location-dot"></i><span id="modal-address">åœ°å€</span></div>
                <div class="info-row" id="modal-price-row"><i class="fa-solid fa-money-bill-wave"></i><span id="modal-price"></span></div>
                
                <div class="note-box">
                    <div style="font-weight:bold; margin-bottom:8px; color:var(--accent-color);">è©³ç´°å°èˆªèˆ‡ TIPSï¼š</div>
                    <span id="modal-note">å…§å®¹...</span>
                </div>
                <div id="modal-links" style="margin-bottom: 20px;"></div>
                
                <div style="display:grid; grid-template-columns: 1fr 1fr; gap:10px; margin-top:20px;">
                     <button class="action-btn" id="modal-map-btn" style="margin-top:0;"><i class="fa-solid fa-map-location-dot"></i> Google å°èˆª</button>
                     <button class="action-btn" onclick="toggleTaxiCard()" style="margin-top:0; background:#444; color:#fff;"><i class="fa-solid fa-taxi"></i> çµ¦å¸æ©Ÿçœ‹</button>
                </div>
            </div>
        </div>
    </div>

    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script>
        // --- DATA: ç¦å²¡ 2/14 - 2/20 è¡Œç¨‹ (è©³ç´°å°èˆªç‰ˆ) ---
        const scheduleData = {
            "day1": {
                "date": "2/14 (å…­)",
                "events": [
                    { 
                        time: "17:10 æŠµé” â” 18:30 é…’åº—", 
                        title: "æŠµé”ç¦å²¡æ©Ÿå ´ & é…’åº—", 
                        type: "äº¤é€š", 
                        price: "å·´å£« Â¥310", 
                        address: "ç¦å²¡å¸‚åšå¤šåŒºåšå¤šé§…æ±1-17-17", 
                        coords: [33.5905, 130.4230], 
                        note: "<b>âš ï¸ è·¯ç—´ç”Ÿå­˜æ³•å‰‡ï¼š</b>é…’åº—åœ¨<span style='color:red; font-weight:bold;'>ç­‘ç´«å£ (Chikushi)</span>ï¼ˆå¾Œç«™ï¼‰ï¼Œåƒè¬ä¸è¦èµ°å»åšå¤šå£ï¼<br><br><b>ğŸšŒ äº¤é€šæŒ‡å¼•ï¼š</b><br>1. å…¥å¢ƒå¤§å ‚ç›´èµ°æ‰¾ã€Œ2è™Ÿå·´å£«ç«™ã€ã€‚<br>2. æ­å¾€ã€Œåšå¤šé§…ã€å·´å£«ã€‚<br>3. <b>ä¸‹è»Šåœ°é»ï¼š</b><span style='color:red'>åšå¤šé§…ç­‘ç´«å£</span>ã€‚<br>4. é¢å‘è»Šç«™å³è½‰ï¼Œæ²¿å¤§é¦¬è·¯ï¼ˆåšå¤šé§…æ±è¡—ï¼‰ç›´èµ°4åˆ†é˜ã€‚<br>5. éç¬¬ä¸€å€‹ç´…ç¶ ç‡ˆå¾Œï¼Œé…’åº—å°±åœ¨<b>å³æ‰‹é‚Š</b>ï¼ˆä¸ç”¨éå°é¢é¦¬è·¯ï¼‰ã€‚", 
                        tags: ["ç§»å‹•", "å¿…è®€", "è·¯ç—´TIPS"], 
                        shopping_items: ["ICå¡å„²å€¼", "ä¾¿åˆ©å•†åº—æ°´"] 
                    },
                    { 
                        time: "18:30 - 19:30 (é–‹æ”¾è‡³21:00)", 
                        title: "ä½å‰é…’è²© (åšå¤šç«™å…§)", 
                        type: "æ¸…é…’", 
                        price: "Â¥2,000", 
                        address: "åšå¤š Deitos Annex 1F", 
                        coords: [33.5898, 130.4210], 
                        note: "<b>ğŸš¶ äº¤é€šæŒ‡å¼•ï¼š</b><br>1. é›¢é–‹é…’åº—ï¼ŒåŸè·¯èµ°å›<span style='color:red'>ç­‘ç´«å£</span>ã€‚<br>2. é€²å¤§é–€å¾Œ<b>ä¸è¦éå‰ªç¥¨å£</b>ã€‚<br>3. ç«‹åˆ»å‘å³çœ‹ï¼Œæ‰¾ã€ŒDeitos Annexã€æ‹›ç‰Œã€‚<br>4. ç›´èµ°ç´„50ç±³å·¦æ‰‹é‚Šã€‚<br><br><b>é«”é©—ï¼š</b>ç”¨èŠ±æœ­ä»£å¹£æ›é…’å–ï¼Œå¿…è²·ä¹å·é™å®šã€Œç„¡æ¿¾éç”ŸåŸé…’ã€ã€‚", 
                        tags: ["æ¸…é…’", "å¿…å»"], 
                        shopping_items: ["ç„¡æ¿¾éç”ŸåŸé…’", "ä¹å·ç´”ç±³é…’"] 
                    },
                    { 
                        time: "19:30 - 21:00 (é–‹æ”¾è‡³23:00)", 
                        title: "åšå¤šç‰›è…¸é‹ é£¯å±±", 
                        type: "ç¾é£Ÿ", 
                        price: "Â¥2,500", 
                        address: "åšå¤š Deitos 1F éºµè¡—é“", 
                        coords: [33.5900, 130.4205], 
                        note: "<b>ğŸš¶ äº¤é€šæŒ‡å¼•ï¼š</b><br>1. èµ°å‡ºä½å‰é…’è²©ï¼Œå›åˆ°è»Šç«™é€šé“ã€‚<br>2. å¾€è»Šç«™ä¸­å¿ƒèµ°ï¼Œé€²å…¥ã€Œåšå¤š Deitosã€å€åŸŸã€‚<br>3. æ‰¾ã€Œåšå¤šéºµè¡—é“ã€ï¼ˆæœ‰ç´…ç‡ˆç± è£é£¾ï¼‰ã€‚<br>4. æ‰¾ä¸åˆ°è«‹ç§€æ—¥æ–‡ï¼šã€Œåšå¤šã‚‚ã¤é‹ ãŠãŠã‚„ã¾ã€ã€‚<br><br><b>å¿…é»ï¼š</b>å‘³å™Œç‰›è…¸é‹ã€ç”Ÿå•¤é…’ã€‚", 
                        link: "https://resy.com/cities/fukuoka-japan/venues/hakata-motsunabe-ooyama-deitos-hakata", 
                        tags: ["ç¾é£Ÿ", "ç‰›è…¸é‹"] 
                    }
                ]
            },
            "day2": {
                "date": "2/15 (æ—¥)",
                "events": [
                    { 
                        time: "09:00 å‡ºç™¼ - 15:30", 
                        title: "åŸå³¶é…’è—ã³ã‚‰ã (é…’ç¥­)", 
                        type: "ç¥­å…¸", 
                        price: "è©¦é£²åˆ¸ Â¥2,000", 
                        address: "ä¹…ç•™ç±³å¸‚åŸå³¶ç”º", 
                        coords: [33.2675, 130.4243], 
                        note: "<b>ğŸš† å»ç¨‹æŒ‡å¼•ï¼š</b><br>1. é…’åº—èµ°å›<span style='color:red'>ç­‘ç´«å£</span>é€²ç«™ï¼ˆåˆ·ICå¡ï¼‰ã€‚<br>2. æ­JRé¹¿å…’å³¶æœ¬ç·šå¾€ã€Œä¹…ç•™ç±³/å¤§ç‰Ÿç”°ã€æ–¹å‘ã€‚<br>3. åœ¨<b>ã€Œè’æœ¨ç«™ (Araki)ã€</b>ä¸‹è»Šï¼ˆç´„30-45åˆ†ï¼‰ã€‚<br>4. å‡ºç«™è·Ÿäººç¾¤èµ°ï¼Œæ­å…è²»æ¥é§å·´å£«ã€‚<br><br><b>æ´»å‹•ï¼š</b>ä¹å·æœ€å¤§æ—©æ˜¥é…’ç¥­ï¼", 
                        link: "http://nanbu-shoko.jp/sakagura/", 
                        tags: ["æ¸…é…’", "ç¥­å…¸", "é‡é»"], 
                        shopping_items: ["æ–°é…’", "é…’ç²•", "é…’å™¨"] 
                    },
                    { 
                        time: "16:30 - 18:00 (é–‹æ”¾è‡³21:00)", 
                        title: "LOPIA è¶…å¸‚ (Yodobashi)", 
                        type: "è³¼ç‰©", 
                        price: "Â¥3,000", 
                        address: "Yodobashi åšå¤š 4F", 
                        coords: [33.5888, 130.4225], 
                        note: "<b>ğŸš¶ å›ç¨‹æŒ‡å¼•ï¼š</b><br>1. æ­æ¥é§è»Šå›è’æœ¨ç«™ â” JRå›åšå¤šç«™ã€‚<br>2. å‹™å¿…å¾<span style='color:red'>ç­‘ç´«å£</span>å‡ºç«™ï¼<br>3. å‡ºç«™å‘å³çœ‹ï¼Œé‚£æ£Ÿå¤§é›»å™¨è¡Œå°±æ˜¯ã€‚<br>4. é›»æ¢¯ç›´ä¸Š4Fã€‚<br><br><b>âš ï¸ æ³¨æ„ï¼šåªæ”¶ç¾é‡‘ï¼</b>", 
                        tags: ["è¶…å¸‚", "ç¾é‡‘"], 
                        shopping_items: ["ä¹å·èª¿å‘³æ–™", "ç†Ÿé£Ÿä¾¿ç•¶", "æ´—æµ´ç”¨å“"] 
                    },
                    { 
                        time: "18:30 - 20:30 (é–‹æ”¾è‡³23:30)", 
                        title: "åšå¤šé›çš®å¤§è‡£ (KITTE)", 
                        type: "ç¾é£Ÿ", 
                        price: "Â¥2,500", 
                        address: "KITTEåšå¤š B1", 
                        coords: [33.5892, 130.4185], 
                        note: "<b>ğŸš¶ äº¤é€šæŒ‡å¼•ï¼š</b><br>1. å¾Yodobashièµ°å›ç­‘ç´«å£ã€‚<br>2. <b>ç©¿è¶Šæ•´å€‹è»Šç«™å¤§å»³</b>èµ°åˆ°è¥¿é‚Šçš„<span style='color:red'>åšå¤šå£</span>ã€‚<br>3. å‡ºå¤§é–€å·¦çœ‹ï¼Œé€£è‘—è»Šç«™çš„å¤§æ¨“å°±æ˜¯ KITTEã€‚<br>4. ä¸‹B1ç¾é£Ÿè¡—ç›´èµ°å³æ‰‹é‚Šã€‚<br><br><b>å¿…é»ï¼š</b>é†¬æ±é›çš®ä¸²ã€Highballã€‚", 
                        tags: ["ç‡’é³¥", "å±…é…’å±‹"] 
                    }
                ]
            },
            "day3": {
                "date": "2/16 (ä¸€)",
                "events": [
                    { 
                        time: "09:30 å‡ºç™¼ - 12:00", 
                        title: "å¤ªå®°åºœå¤©æ»¿å®®", 
                        type: "ç¥ç¤¾", 
                        price: "å·´å£« Â¥610", 
                        address: "å¤ªå®°åºœå¸‚å®°åºœ4-7-1", 
                        coords: [33.5215, 130.5349], 
                        note: "<b>ğŸšŒ å»ç¨‹æŒ‡å¼• (å·´å£«ç¸½ç«™)ï¼š</b><br>1. ç©¿éè»Šç«™åˆ°<span style='color:red'>åšå¤šå£</span>ã€‚<br>2. å³æ‰‹é‚Šå¤§æ¨“ã€Œåšå¤šãƒã‚¹ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã€ä¸Š1æ¨“ã€‚<br>3. èµ°åˆ°<b>11è™Ÿæœˆå°</b>ï¼ˆåœ°é¢æœ‰ç²‰ç´…ç·šï¼‰ã€‚<br>4. æ­ä¹˜ã€Œæ—…äºº (Tabito)ã€è™Ÿç›´é”å¤ªå®°åºœã€‚<br><br><b>æ´»å‹•ï¼š</b>æ¢…èŠ±å­£ã€åƒæ¢…æé¤…ã€‚", 
                        tags: ["ç¥ç¤¾", "æ¢…èŠ±", "ç§»å‹•"], 
                        shopping_items: ["ç‰›å½¢ç¹ªé¦¬", "å¾¡å®ˆ", "æ¢…æé¤…"] 
                    },
                    { 
                        time: "12:00 - 14:00 (é–‹æ”¾è‡³17:00)", 
                        title: "ç«ˆé–€ç¥ç¤¾ (æ±‚è‰¯ç·£)", 
                        type: "ç¥ç¤¾", 
                        price: "å·´å£« Â¥100", 
                        address: "å¤ªå®°åºœå¸‚å…§å±±833", 
                        coords: [33.5350, 130.5500], 
                        note: "<b>ğŸšŒ äº¤é€šæŒ‡å¼•ï¼š</b><br>1. èµ°å›è¥¿éµå¤ªå®°åºœç«™ã€‚<br>2. ç«™å‰æ­ç¤¾å€å·´å£«ã€Œã¾ã»ã‚ã°å· (Mahoroba)ã€ã€‚<br>3. çµ‚é»ç«™ã€Œå†…å±±ã€ä¸‹è»Šã€‚<br><br><b>é‡é»ï¼š</b>éå¸¸éˆé©—çš„çµç·£ç¥ç¤¾ï¼Œå¾¡å®ˆå¾ˆç¾ã€‚", 
                        tags: ["çµç·£", "ç¥ç¤¾"], 
                        shopping_items: ["ç²‰ç´…çµç·£å¾¡å®ˆ"] 
                    },
                    { 
                        time: "15:00 - 17:00 (é–‹æ”¾è‡³21:00)", 
                        title: "åšå¤šæ¹¯ (äºŒæ—¥å¸‚æº«æ³‰)", 
                        type: "æº«æ³‰", 
                        price: "Â¥550", 
                        address: "ç­‘ç´«é‡å¸‚æ¹¯ç”º1-14-5", 
                        coords: [33.4930, 130.5180], 
                        note: "<b>ğŸš† äº¤é€šæŒ‡å¼•ï¼š</b><br>1. æ­å·´å£«å›è¥¿éµå¤ªå®°åºœç«™ã€‚<br>2. æ­è¥¿éµé›»è»Šå2ç«™åˆ°ã€Œè¥¿éµäºŒæ—¥å¸‚ç«™ã€ã€‚<br>3. è¥¿å£å‡ºç«™å³è½‰ï¼Œæ²¿å•†åº—è¡—ç›´èµ°10åˆ†é˜ã€‚<br>4. èªå¤è‰²å¤é¦™æœ¨é€ å»ºç¯‰ã€‚<br><br><b>ä¸­é€”ï¼š</b>åƒé“ä¸Šå¯åƒã€ŒèŒ¶å’Œã€…ã€æŠ¹èŒ¶å†°ã€‚", 
                        tags: ["æº«æ³‰"], 
                        shopping_items: ["æº«æ³‰é¹½"] 
                    },
                    { 
                        time: "19:00 - 21:00 (é–‹æ”¾è‡³00:00)", 
                        title: "æ—­è»’ (ä¸€å£é¤ƒå­)", 
                        type: "ç¾é£Ÿ", 
                        price: "Â¥2,000", 
                        address: "åšå¤šé§…å‰2-15-22", 
                        coords: [33.5880, 130.4160], 
                        note: "<b>ğŸš† å›ç¨‹æŒ‡å¼•ï¼š</b><br>1. å¾åšå¤šæ¹¯æ­¥è¡Œåˆ°<b>ã€ŒJRäºŒæ—¥å¸‚ç«™ã€</b>ï¼ˆéè¥¿éµï¼Œç´„10åˆ†ï¼‰ã€‚<br>2. æ­JRå›åšå¤šç«™ã€‚<br>3. <span style='color:red'>åšå¤šå£</span>å‡ºç«™ï¼Œç›´èµ°éé¦¬è·¯ç´„5åˆ†é˜ã€‚<br>4. åœ¨å··å­è£¡ï¼Œå»ºè­°é–‹Google Mapã€‚", 
                        tags: ["é¤ƒå­"] 
                    }
                ]
            },
            "day4": {
                "date": "2/17 (äºŒ)",
                "events": [
                    { 
                        time: "09:00 å‡ºç™¼ (10:30è¦‹å­¸)", 
                        title: "éº’éºŸå•¤é…’å·¥å»  & ç”˜æœ¨éµé“", 
                        type: "é«”é©—", 
                        price: "Â¥810 + Â¥500", 
                        address: "æœå€‰å¸‚é¦¬ç”°3601", 
                        coords: [33.3900, 130.6050], 
                        note: "<b>ğŸš† äº¤é€šæŒ‡å¼• (éœ€è½‰è»Š)ï¼š</b><br>1. <span style='color:red'>ç­‘ç´«å£</span>é€²ç«™ï¼Œæ­JRåˆ°ã€ŒåŸºå±±ç«™ (Kiyama)ã€ã€‚<br>2. ç«™å…§è½‰ä¹˜ã€Œç”˜æœ¨éµé“ã€ï¼ˆå°ç«è»Šï¼Œ<b style='color:red'>å‚™ç¾é‡‘</b>ï¼‰ã€‚<br>3. åœ¨ã€Œå¤ªåˆ€æ´—ç«™ã€ä¸‹è»Šï¼Œæ­¥è¡Œ15åˆ†ã€‚<br><br><b>éœ€é ç´„ï¼š</b>è©¦é£²3æ¯ (ä¸€ç•ªæ¾ç­‰)ã€‚", 
                        link: "https://www.kirin.co.jp/experience/factory/fukuoka/", 
                        tags: ["å•¤é…’", "éµé“", "ç¾é‡‘"], 
                        shopping_items: ["å•¤é…’æ¯", "é™å®šå•¤é…’"] 
                    },
                    { 
                        time: "13:30 å‡ºç™¼ - 17:00", 
                        title: "å—è—é™¢ (æ¶…æ§ƒä½›)", 
                        type: "ç¥ç¤¾", 
                        price: "Â¥300", 
                        address: "ç¯ æ —ç”ºç¯ æ —1035", 
                        coords: [33.6160, 130.5600], 
                        note: "<b>ğŸš† äº¤é€šæŒ‡å¼•ï¼š</b><br>1. åŸè·¯å›åŸºå±±ç«™ï¼Œæ­JRå›åšå¤šç«™ã€‚<br>2. <b>ä¸è¦å‡ºç«™</b>ï¼Œè½‰ç¬¬8æœˆå°ã€ŒJRç¯ æ —ç·šã€ã€‚<br>3. å¾€ç¯ æ —/ç›´æ–¹æ–¹å‘ï¼Œåœ¨ã€ŒåŸæˆ¸å—è”µé™¢å‰ã€ä¸‹è»Šã€‚<br>4. å‡ºç«™éæ©‹å·¦è½‰ä¸Šå¡ã€‚<br><br><b>çœ‹é»ï¼š</b>ä¸–ç•Œæœ€å¤§é’éŠ…æ¶…æ§ƒä½›ã€‚", 
                        tags: ["ç¥ç¤¾", "å¤§ä½›"], 
                        shopping_items: ["å¼·åŠ›å¾¡å®ˆ"] 
                    },
                    { 
                        time: "18:30 - 20:30 (é–‹æ”¾è‡³23:00)", 
                        title: "æµ·é¢¨åœŸ (æµ·é®®å±…é…’å±‹)", 
                        type: "ç¾é£Ÿ", 
                        price: "Â¥3,000", 
                        address: "åšå¤šé§…æ±2-4-17", 
                        coords: [33.5910, 130.4250], 
                        note: "<b>ğŸš¶ äº¤é€šæŒ‡å¼•ï¼š</b><br>1. æ­JRå›åšå¤šï¼Œ<span style='color:red'>ç­‘ç´«å£</span>å‡ºç«™ã€‚<br>2. å³è½‰æ²¿åšå¤šé§…æ±è¡—èµ°5åˆ†é˜ã€‚<br>3. é›¢é…’åº—éå¸¸è¿‘ã€‚<br><br><b>å¿…é»ï¼š</b>æµ·ä¹‹ç‰æ‰‹ç®±ç”Ÿé­šç‰‡ã€‚", 
                        tags: ["æµ·é®®", "å±…é…’å±‹"] 
                    }
                ]
            },
            "day5": {
                "date": "2/18 (ä¸‰)",
                "events": [
                    { 
                        time: "08:00 å‡ºç™¼ - 13:00", 
                        title: "åˆ¥åºœé¦™æ°´åšç‰©é¤¨", 
                        type: "é«”é©—", 
                        price: "Â¥4,000+", 
                        address: "åˆ¥åºœå¸‚åŒ—çŸ³å£48-1", 
                        coords: [33.3000, 131.4900], 
                        note: "<b>ğŸš† äº¤é€šæŒ‡å¼•ï¼š</b><br>1. åšå¤šç«™æ­<b>ã€Œç‰¹æ€¥ Sonic (è—è‰²éŸ³é€Ÿè™Ÿ)ã€</b>å¾€å¤§åˆ†ã€‚<br>2. <b>ã€Œåˆ¥åºœç«™ã€</b>ä¸‹è»Šã€‚<br>3. è¥¿å£æ­é¾œä¹‹äº•å·´å£«åˆ°ã€Œåˆ¥åºœå¤§å­¸ä¸‹ã€ï¼Œæ­¥è¡Œ5åˆ†ã€‚<br><br><b>é‡é»ï¼š</b>èª¿è£½å°ˆå±¬é¦™æ°´ã€‚", 
                        tags: ["éµé“", "é¦™æ°›"], 
                        shopping_items: ["è‡ªè£½é¦™æ°´"] 
                    },
                    { 
                        time: "13:00 - 17:00", 
                        title: "ç«¹ç“¦æº«æ³‰ & Beppu Brewery", 
                        type: "æº«æ³‰", 
                        price: "Â¥1,500", 
                        address: "åˆ¥åºœå¸‚å…ƒç”º16-23", 
                        coords: [33.2760, 131.5050], 
                        note: "<b>ğŸš¶ äº¤é€šæŒ‡å¼•ï¼š</b><br>1. æ­å·´å£«å›åˆ¥åºœç«™ã€‚<br>2. åˆé¤ï¼šç«™å‰ Beppu Breweryã€‚<br>3. æº«æ³‰ï¼šå¾€æµ·é‚Šæ²¿ã€Œé§…å‰é€šã€èµ°ï¼Œä¾å°èˆªå³è½‰å…¥å··ï¼ˆå¤è€æœ¨é€ å»ºç¯‰ï¼‰ã€‚<br><br><b>é«”é©—ï¼š</b>ç†±ç ‚æµ´ï¼ˆå»ºè­°å…ˆæ‹¿è™Ÿç¢¼ç‰Œï¼‰ã€‚", 
                        tags: ["æº«æ³‰", "ç ‚æ¹¯", "å•¤é…’"] 
                    },
                    { 
                        time: "19:30 - 21:00 (é–‹æ”¾è‡³00:00)", 
                        title: "åšå¤šä¸€é›™ (è±šéª¨æ‹‰éºµ)", 
                        type: "ç¾é£Ÿ", 
                        price: "Â¥1,000", 
                        address: "åšå¤šé§…æ±æœ¬åº—", 
                        coords: [33.5905, 130.4245], 
                        note: "<b>ğŸš¶ å›ç¨‹æŒ‡å¼•ï¼š</b><br>1. æ­Sonicç‰¹æ€¥å›åšå¤šï¼Œ<span style='color:red'>ç­‘ç´«å£</span>å‡ºç«™ã€‚<br>2. å³è½‰æ­¥è¡Œ5-8åˆ†é˜ã€‚<br>3. èªæ˜æ’éšŠäººæ½®èˆ‡æ¿ƒéƒè±šéª¨å‘³ã€‚", 
                        tags: ["æ‹‰éºµ", "æ’éšŠåº—"] 
                    }
                ]
            },
            "day6": {
                "date": "2/19 (å››)",
                "events": [
                    { 
                        time: "09:00 å‡ºç™¼ (10:00é ç´„)", 
                        title: "Haku Haku æ˜å¤ªå­æ‰‹ä½œ", 
                        type: "é«”é©—", 
                        price: "Â¥2,200", 
                        address: "å‰å¡šç«™é™„è¿‘", 
                        coords: [33.6050, 130.4300], 
                        note: "<b>ğŸš† äº¤é€šæŒ‡å¼•ï¼š</b><br>1. åšå¤šç«™æ­JRï¼ˆå¾€å°å€‰ï¼‰å1ç«™åˆ°<b>ã€Œå‰å¡šç«™ã€</b>ã€‚<br>2. <b>æ±å£</b>å‡ºä¾†ã€‚<br>3. âš ï¸ <b>è·¯ç—´æ³¨æ„ï¼š</b>é€™æ®µè·¯ç´„13åˆ†ï¼Œå‹™å¿…é–‹Google Mapæ²¿å¤§è·¯èµ°ï¼Œä¸è¦é‘½å··å­ã€‚<br><br><b>æ´»å‹•ï¼š</b>DIYæ˜å¤ªå­ã€‚", 
                        tags: ["é«”é©—", "æ˜å¤ªå­"], 
                        shopping_items: ["è‡ªè£½æ˜å¤ªå­"] 
                    },
                    { 
                        time: "11:15 - 12:30", 
                        title: "ä¸­æ´²å·ç«¯ & ç·šé¦™", 
                        type: "è³¼ç‰©", 
                        price: "Â¥1,000", 
                        address: "å·ç«¯å•†åº—è¡—", 
                        coords: [33.5930, 130.4100], 
                        note: "<b>ğŸš‡ äº¤é€šæŒ‡å¼•ï¼š</b><br>1. å›å‰å¡šç«™æ­JRå›åšå¤šã€‚<br>2. è½‰ä¹˜ã€Œåœ°ä¸‹éµç©ºæ¸¯ç·šã€ï¼ˆå¾€å¤©ç¥/å§ªæµœï¼‰ã€‚<br>3. <b>ã€Œä¸­æ´²å·ç«¯ç«™ã€</b>ä¸‹è»Šï¼Œ5è™Ÿå‡ºå£ã€‚<br><br><b>é€›ï¼š</b>å¸‚å·é¦™èˆ–è²·ç·šé¦™ã€‚", 
                        tags: ["é¦™æ°›", "åœ°éµ"], 
                        shopping_items: ["ç·šé¦™"] 
                    },
                    { 
                        time: "12:30 - 14:00 (åˆé¤)", 
                        title: "ç‡’è‚‰ BAKURO (å¤§å)", 
                        type: "ç¾é£Ÿ", 
                        price: "Â¥3,000", 
                        address: "å¤§ååº—", 
                        coords: [33.5870, 130.3950], 
                        note: "<b>ğŸš‡ äº¤é€šæŒ‡å¼•ï¼š</b><br>1. ç¹¼çºŒæ­ç©ºæ¸¯ç·šåˆ°<b>ã€Œèµ¤å‚ç«™ã€</b>ã€‚<br>2. æ­¥è¡Œ5åˆ†é˜ï¼ˆå··å¼„å¤šï¼Œé–‹å°èˆªï¼‰ã€‚<br><br><b>å¿…é»ï¼š</b>åˆé–“å’Œç‰›å¥—é¤ã€‚", 
                        tags: ["ç‡’è‚‰", "å’Œç‰›"] 
                    },
                    { 
                        time: "16:30 - 18:00 (é–‹æ”¾è‡³20:00)", 
                        title: "MY ONLY FRAGRANCE", 
                        type: "é«”é©—", 
                        price: "Â¥5,000", 
                        address: "ä¸­å¤®åŒºå¤§å1-1-35", 
                        coords: [33.5865, 130.3960], 
                        note: "<b>ğŸš¶ äº¤é€šæŒ‡å¼•ï¼š</b><br>é›¢åˆé¤åœ°é»å’Œå¤©ç¥å•†åœˆæ­¥è¡Œå¯é”ã€‚<br>å»ºè­°é€›å®Œå¤©ç¥è¶…å¸‚å¾Œå°èˆªèµ°éä¾†ï¼ˆç´„10-15åˆ†ï¼‰ã€‚<br><br><b>æ´»å‹•ï¼š</b>ç¬¬äºŒæ¬¡èª¿é¦™ã€‚", 
                        tags: ["é¦™æ°›"], 
                        shopping_items: ["å°ˆå±¬é¦™æ°´"] 
                    }
                ]
            },
            "day7": {
                "date": "2/20 (äº”)",
                "events": [
                    { 
                        time: "11:00 - 12:00 (é–‹æ”¾è‡³19:00)", 
                        title: "åšå¤šç™¾å¹´è— (çŸ³è—é…’é€ )", 
                        type: "æ¸…é…’", 
                        price: "å…è²»", 
                        address: "åšå¤šåŒºå …ç²•1-30-1", 
                        coords: [33.6000, 130.4250], 
                        note: "<b>ğŸš• äº¤é€šæŒ‡å¼•ï¼š</b><br>1. Check-out è¡Œæå¯„æ”¾é…’åº—ã€‚<br>2. <b>å¼·çƒˆå»ºè­°æ­è¨ˆç¨‹è»Š</b>ï¼ˆå¾é…’åº—å‡ºç™¼ç´„Â¥1,000ï¼‰ã€‚<br>3. çµ¦å¸æ©Ÿçœ‹ï¼šã€ŒHakata Hyakunen-gura, pleaseã€ã€‚<br><br><b>æ´»å‹•ï¼š</b>åƒè§€å¤è€é…’é€ ã€è²·åœ°é…’ã€‚", 
                        tags: ["æ¸…é…’", "æ­·å²"], 
                        shopping_items: ["åšå¤šåœ°é…’"] 
                    },
                    { 
                        time: "12:15 - 14:00 (åˆé¤)", 
                        title: "Sushi Yamanaka (å£½å¸)", 
                        type: "ç¾é£Ÿ", 
                        price: "Â¥5,000", 
                        address: "JRåšå¤šCity 9F", 
                        coords: [33.5900, 130.4200], 
                        note: "<b>ğŸš¶ äº¤é€šæŒ‡å¼•ï¼š</b><br>1. å›åšå¤šç«™ï¼ˆæ­è»Šæˆ–èµ°ï¼‰ã€‚<br>2. <span style='color:red'>åšå¤šå£</span>å¤§æ¨“é›»æ¢¯ä¸Š9F (Kuuten)ã€‚<br><br><b>å¿…é»ï¼š</b>ç‰¹é¸æ¡å£½å¸ã€‚", 
                        link: "https://tabelog.com/fukuoka/A4001/A400101/40026367/", 
                        tags: ["å£½å¸", "å¥¢è¯"] 
                    },
                    { 
                        time: "14:00 å·´å£« (16:05èµ·é£›)", 
                        title: "å‰å¾€æ©Ÿå ´", 
                        type: "äº¤é€š", 
                        price: "å·´å£« Â¥310", 
                        address: "åšå¤šå·´å£«ç¸½ç«™", 
                        coords: [33.5915, 130.4180], 
                        note: "<b>âš ï¸ æœ€å¾Œè¡åˆºï¼š</b><br>1. åƒå®Œé£¯å›é…’åº—æ‹¿è¡Œæã€‚<br>2. èµ°åˆ°<span style='color:red'>åšå¤šå£</span>å·´å£«ç¸½ç«™1Fã€‚<br>3. <b>11è™Ÿæœˆå°</b>æ­ã€Œåœ‹éš›ç·šç›´é”å·´å£«ã€ã€‚<br>4. <b style='color:red'>å‹™å¿… 14:00 å‰ä¸Šè»Šï¼</b>", 
                        tags: ["ç§»å‹•", "å¿…è®€"], 
                        shopping_items: [] 
                    }
                ]
            }
        };

        const packingList = ["è­·ç…§", "ICOCA/Suica", "è¡Œå‹•é›»æº", "ä¿æº«ç“¶ (é‡è¦)", "æŠ˜ç–Šå‚˜", "å¥½èµ°çš„é‹", "è—¥å“", "ç¶²å¡/Wifi", "å°é¡ç¾é‡‘ (Â¥30,000)", "é›¶éŒ¢åŒ… (ç¥ç¤¾ç”¨)"];
        const generalShoppingListItems = ["ç„¡æ¿¾éç”ŸåŸé…’", "é…’ç²•/é…’å™¨", "ä¹å·èª¿å‘³æ–™ (æŸšå­èƒ¡æ¤’)", "Loipa ç†Ÿé£Ÿ", "æ¢…æé¤…", "æ˜å¤ªå­ (è‡ªè£½/è³¼è²·)", "åšå¤šç·šé¦™", "è‡ªè£½é¦™æ°´", "æŠ¹èŒ¶ç²‰", "æº«æ³‰é¹½"];

        let currentDay = "day1";
        let map = null;
        let markers = [];
        let waterCount = 0;

        // --- Logic ---
        function init() { 
            renderDateSelector(); 
            selectDay('day1', document.querySelector('.date-chip')); // Default Init
            renderPackingList();
            renderGeneralShoppingList();
            initMap();
        }

        function switchMainPage(pageId, navEl) {
            document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
            document.getElementById('page-' + pageId).classList.add('active');
            
            document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
            if(navEl) {
                navEl.classList.add('active');
            } else {
                const idx = ['itinerary', 'map', 'weather', 'shopping'].indexOf(pageId);
                if(idx !== -1) document.querySelectorAll('.nav-item')[idx].classList.add('active');
            }

            if(pageId === 'map' && map) {
                setTimeout(() => { map.invalidateSize(); fitMapToDay(); }, 200);
            }
        }

        function openToolsPage() {
            document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
            document.getElementById('page-tools').classList.add('active');
            document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
        }

        function openSubPage(id) { document.getElementById('subpage-' + id).classList.add('open'); }
        function closeSubPage(id) { document.getElementById('subpage-' + id).classList.remove('open'); }

        function renderDateSelector() {
            const container = document.getElementById('date-selector'); container.innerHTML = '';
            Object.keys(scheduleData).forEach(dayKey => {
                const dayInfo = scheduleData[dayKey];
                const dayNum = dayKey.replace('day', '');
                const chip = document.createElement('div');
                chip.className = `date-chip ${dayKey === 'day1' ? 'active' : ''}`;
                chip.onclick = () => selectDay(dayKey, chip);
                chip.innerHTML = `<span class="day-num">D${dayNum}</span><span class="day-week">${dayInfo.date.split(' ')[0]}</span>`;
                container.appendChild(chip);
            });
        }

        function selectDay(dayKey, chipEl) {
            currentDay = dayKey;
            document.querySelectorAll('.date-chip').forEach(c => c.classList.remove('active'));
            chipEl.classList.add('active');
            
            renderTimeline(dayKey);
            renderWeather(dayKey);
            renderDailyShopping(dayKey);
            if(map) updateMapMarkers(dayKey);
        }

        function renderTimeline(dayKey) {
            const container = document.getElementById('timeline-container'); container.innerHTML = '';
            const dayTitle = document.createElement('h3'); dayTitle.style.marginBottom='20px';
            dayTitle.innerHTML = `<span style="color:var(--accent-color); font-weight:700;">${scheduleData[dayKey].date}</span>`;
            container.appendChild(dayTitle);

            scheduleData[dayKey].events.forEach(event => {
                const item = document.createElement('div'); item.className = 'timeline-item';
                let tagsHtml = event.tags.map(t => {
                    let c = 'card-tag'; 
                    if(t.includes('å¿…')||t.includes('é‡é»')||t.includes('é…’')) c+=' highlight';
                    if(t.includes('æ³¨æ„')||t.includes('ç¾é‡‘')) c+=' alert';
                    return `<span class="${c}">${t}</span>`;
                }).join('');
                
                let priceHtml = event.price ? `<div class="card-price">${event.price}</div>` : '';

                item.innerHTML = `<div class="card" onclick='openEventModal(${JSON.stringify(event)})'>
                    <span class="card-time">${event.time}</span>
                    <h3 class="card-title">${event.title}</h3>
                    <div class="tags">${tagsHtml}</div>
                    ${priceHtml}
                </div>`;
                container.appendChild(item);
            });
        }

        function renderWeather(dayKey) {
            const container = document.getElementById('weather-content');
            // 2æœˆç¦å²¡å¤©æ°£é‚è¼¯
            const baseTemp = 6; 
            const dayIndex = parseInt(dayKey.replace('day', ''));
            const temp = baseTemp + (dayIndex % 3);
            const humidity = 60 + (dayIndex % 5);
            
            let icon = "fa-cloud-sun";
            let desc = "å¤šé›²ä¹¾å†·";
            let rainChance = 20;

            if(dayIndex % 4 === 0) { icon = "fa-cloud-showers-heavy"; desc = "å¯’å†·æœ‰é›¨"; rainChance = 60; }
            else if (dayIndex % 3 === 0) { icon = "fa-sun"; desc = "æ™´æœ—å¯’å†·"; rainChance = 10; }

            container.innerHTML = `
                <div class="weather-card">
                    <div style="font-size:0.9rem; opacity:0.9;">${scheduleData[dayKey].date} â€¢ ç¦å²¡</div>
                    <div class="weather-main">
                        <div class="weather-icon"><i class="fa-solid ${icon}"></i></div>
                        <div class="weather-temp">${temp}Â°C</div>
                    </div>
                    <div style="font-size:1.2rem; margin-bottom:15px;">${desc}</div>
                    <div class="weather-grid">
                        <div class="w-item"><i class="fa-solid fa-droplet"></i> æ¿•åº¦ ${humidity}%</div>
                        <div class="w-item"><i class="fa-solid fa-umbrella"></i> é™é›¨ ${rainChance}%</div>
                        <div class="w-item"><i class="fa-solid fa-wind"></i> é¢¨é€Ÿ 4ç´š</div>
                        <div class="w-item"><i class="fa-solid fa-temperature-arrow-down"></i> é«”æ„Ÿ ${temp-2}Â°</div>
                    </div>
                </div>
            `;
        }
        
        // Add Water
        function addWater() {
            waterCount++;
            document.getElementById('water-count').innerText = waterCount;
        }

        function renderDailyShopping(dayKey) {
            const container = document.getElementById('daily-shopping-list');
            container.innerHTML = '';
            
            const events = scheduleData[dayKey].events;
            let hasItems = false;

            events.forEach(event => {
                if (event.shopping_items && event.shopping_items.length > 0) {
                    hasItems = true;
                    const group = document.createElement('div');
                    group.className = 'shopping-group';
                    
                    let itemsHtml = '';
                    event.shopping_items.forEach((item, i) => {
                        const id = `shop-${dayKey}-${event.title}-${i}`;
                        itemsHtml += `<div class="checklist-item" onclick="toggleCheck(this)">
                            <input type="checkbox" id="${id}">
                            <label for="${id}"><span>${item}</span></label>
                        </div>`;
                    });

                    group.innerHTML = `<h4 class="shopping-section-title"><i class="fa-solid fa-location-dot"></i> ${event.title}</h4>${itemsHtml}`;
                    container.appendChild(group);
                }
            });

            if (!hasItems) {
                container.innerHTML = `<div style="text-align:center; padding:30px; opacity:0.5;">
                    <i class="fa-solid fa-bag-shopping" style="font-size:2rem; margin-bottom:10px;"></i><br>
                    æœ¬æ—¥ä»¥è§€å…‰ç‚ºä¸»ï¼Œç„¡ç‰¹å®šè³¼ç‰©å»ºè­°
                </div>`;
            }
        }

        function renderGeneralShoppingList() {
            const container = document.getElementById('general-shopping-container');
            generalShoppingListItems.forEach((item,i) => {
                container.innerHTML += `<div class="checklist-item" onclick="toggleCheck(this)"><input type="checkbox" id="g${i}"><label for="g${i}"><span>${item}</span></label></div>`;
            });
        }

        function renderPackingList() {
            const pC = document.getElementById('packing-list-container');
            pC.innerHTML = '';
            packingList.forEach((item,i) => pC.innerHTML += `<div class="checklist-item" onclick="toggleCheck(this)"><input type="checkbox" id="p${i}"><label for="p${i}"><span>${item}</span></label></div>`);
        }
        function toggleCheck(el) { const i = el.querySelector('input'); i.checked = !i.checked; el.classList.toggle('checked', i.checked); }

        function calcRate(type) {
            const rate = parseFloat(document.getElementById('rate-setting').value) || 0.052;
            const jpy = document.getElementById('jpy-input'); 
            const hkd = document.getElementById('hkd-input');
            
            if(type==='jpy') {
                if(jpy.value === '') hkd.value = '';
                else hkd.value = (jpy.value * rate).toFixed(1); 
            } else {
                if(hkd.value === '') jpy.value = '';
                else jpy.value = (hkd.value / rate).toFixed(0);
            }
        }

        function sendSafetyMessage() {
             if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(function(pos) {
                    const link = `https://www.google.com/maps/search/?api=1&query=${pos.coords.latitude},${pos.coords.longitude}`;
                    window.open(`https://wa.me/?text=${encodeURIComponent("Hello! æˆ‘åœ¨ç¦å²¡ä¸€åˆ‡å®‰å¥½ï¼Œç›®å‰ä½ç½®ï¼š" + link)}`, '_blank');
                });
            } else alert("ç„¡æ³•ç²å–å®šä½");
        }

        function openEventModal(event) {
            document.getElementById('modal-title').innerText = event.title;
            document.getElementById('modal-type').innerText = event.type;
            document.getElementById('modal-time').innerText = event.time;
            document.getElementById('modal-address').innerText = event.address;
            document.getElementById('modal-note').innerHTML = event.note;
            
            // Setup Taxi Card Data
            document.getElementById('taxi-address').innerText = event.address;
            document.getElementById('taxi-name').innerText = event.title;
            document.getElementById('taxi-card').style.display = 'none'; 

            const priceRow = document.getElementById('modal-price-row');
            if (event.price) {
                priceRow.style.display = 'flex';
                document.getElementById('modal-price').innerText = "é ç®—/é–€ç¥¨ï¼š" + event.price;
            } else {
                priceRow.style.display = 'none';
            }

            const lc = document.getElementById('modal-links'); lc.innerHTML = '';
            if(event.link) lc.innerHTML = `<a href="${event.link}" target="_blank" class="link-btn"><i class="fa-solid fa-link"></i> é ç´„/è©³æƒ…</a>`;
            
            // Map Logic
            let mapUrl = "";
            if(event.coords) {
                mapUrl = `https://www.google.com/maps/search/?api=1&query=${event.coords[0]},${event.coords[1]}`;
            } else {
                const q = encodeURIComponent(event.address + " " + event.title);
                mapUrl = `https://www.google.com/maps/search/?api=1&query=${q}`;
            }
            document.getElementById('modal-map-btn').onclick = () => window.open(mapUrl, '_blank');
            document.getElementById('detail-modal').classList.add('open');
        }
        
        function toggleTaxiCard() {
            const card = document.getElementById('taxi-card');
            card.style.display = card.style.display === 'none' ? 'block' : 'none';
        }

        function closeModal() { document.getElementById('detail-modal').classList.remove('open'); }
        document.getElementById('detail-modal').addEventListener('click', function(e){if(e.target===this)closeModal()});
        function openTipsModal() { openEventModal({title:"è·¯ç—´æ•‘æ˜Ÿ (ç¦å²¡ç‰ˆ)",type:"TIPS",time:"éš¨æ™‚",address:"åšå¤šå…¨å€",note:"1. åšå¤šç«™åˆ†ã€Œåšå¤šå£ã€(è¥¿/å·´å£«) å’Œã€Œç­‘ç´«å£ã€(æ±/æ–°å¹¹ç·š/é…’åº—)ã€‚<br>2. åœ°éµåœ¨åœ°ä¸‹ï¼Œæ¨™ç¤ºé¡è‰²å¾ˆæ¸…æ¥šã€‚<br>3. è¿·è·¯å°±æ‰¾åœ°ä¸Šå·¥ä½œäººå“¡ï¼Œç§€å‡ºæ—¥æ–‡åœ°å€ã€‚<br>4. è¨ˆç¨‹è»Šé–€æœƒè‡ªå‹•é–‹ã€‚", tags:[]}); }

        // --- Map Logic ---
        function initMap() {
            map = L.map('map-container');
            L.tileLayer('https://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}{r}.png', { attribution: 'Â© OpenStreetMap' }).addTo(map);
            updateMapMarkers(currentDay);
        }

        function updateMapMarkers(dayKey) {
            if(!map) return;
            markers.forEach(m => map.removeLayer(m));
            markers = [];
            
            const events = scheduleData[dayKey].events;
            const group = new L.featureGroup();

            events.forEach(event => {
                if(event.coords) {
                    const navUrl = `https://www.google.com/maps/search/?api=1&query=${event.coords[0]},${event.coords[1]}`;
                    const popupContent = `
                        <div style="text-align:center">
                            <b>${event.title}</b><br>${event.time}<br>
                            <a href="${navUrl}" target="_blank" style="display:inline-block; margin-top:5px; color:#EAA800; text-decoration:none; font-weight:bold;">
                                <i class="fa-solid fa-location-arrow"></i> å°èˆª
                            </a>
                        </div>
                    `;
                    const m = L.marker(event.coords).addTo(map).bindPopup(popupContent);
                    markers.push(m);
                    group.addLayer(m);
                }
            });

            if(markers.length > 0) {
                map.fitBounds(group.getBounds(), {padding: [50, 50]});
            } else {
                map.setView([33.5900, 130.4200], 13);
            }
        }
        
        function fitMapToDay() {
            if(map && markers.length > 0) {
                const group = new L.featureGroup(markers);
                map.fitBounds(group.getBounds(), {padding: [50, 50]});
            }
        }

        init();
    </script>
</body>
</html>
